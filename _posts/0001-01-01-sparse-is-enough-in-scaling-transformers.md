---
title: "Sparse is Enough in Scaling Transformers (aka Terraformer) | ML Research Paper Explained"
image: "https:\/\/i.ytimg.com\/vi\/hgSGHusDx7M\/hqdefault.jpg"
vid_id: "hgSGHusDx7M"
categories: "Science-Technology"
tags: ["deep learning","machine learning","arxiv"]
date: "2021-12-03T03:02:48+03:00"
vid_date: "2021-12-02T01:21:29Z"
duration: "PT57M7S"
viewcount: "6548"
likeCount: "249"
dislikeCount: "1"
channel: "Yannic Kilcher"
---
{% raw %}#scalingtransformers #terraformer #sparsity<br /><br />Transformers keep pushing the state of the art in language and other domains, mainly due to their ability to scale to ever more parameters. However, this scaling has made it prohibitively expensive to run a lot of inference requests against a Transformer, both in terms of compute and memory requirements. Scaling Transformers are a new kind of architecture that leverage sparsity in the Transformer blocks to massively speed up inference, and by including additional ideas from other architectures, they create the Terraformer, which is both fast, accurate, and consumes very little memory.<br /><br />OUTLINE:<br />0:00 - Intro &amp; Overview<br />4:10 - Recap: Transformer stack<br />6:55 - Sparse Feedforward layer<br />19:20 - Sparse QKV Layer<br />43:55 - Terraformer architecture<br />55:05 - Experimental Results &amp; Conclusion<br /><br />Paper: <a rel="nofollow" target="blank" href="https://arxiv.org/abs/2111.12763">https://arxiv.org/abs/2111.12763</a><br />Code: <a rel="nofollow" target="blank" href="https://github.com/google/trax/blob/master/trax/examples/Terraformer_from_scratch.ipynb">https://github.com/google/trax/blob/master/trax/examples/Terraformer_from_scratch.ipynb</a><br /><br />Abstract:<br />Large Transformer models yield impressive results on many tasks, but are expensive to train, or even fine-tune, and so slow at decoding that their use and study becomes out of reach. We address this problem by leveraging sparsity. We study sparse variants for all layers in the Transformer and propose Scaling Transformers, a family of next generation Transformer models that use sparse layers to scale efficiently and perform unbatched decoding much faster than the standard Transformer as we scale up the model size. Surprisingly, the sparse layers are enough to obtain the same perplexity as the standard Transformer with the same number of parameters. We also integrate with prior sparsity approaches to attention and enable fast inference on long sequences even with limited memory. This results in performance competitive to the state-of-the-art on long text summarization.<br /><br />Authors: Sebastian Jaszczur, Aakanksha Chowdhery, Afroz Mohiuddin, ≈Åukasz Kaiser, Wojciech Gajewski, Henryk Michalewski, Jonni Kanerva<br /><br />Links:<br />TabNine Code Completion (Referral): <a rel="nofollow" target="blank" href="http://bit.ly/tabnine-yannick">http://bit.ly/tabnine-yannick</a><br />YouTube: <a rel="nofollow" target="blank" href="https://www.youtube.com/c/yannickilcher">https://www.youtube.com/c/yannickilcher</a><br />Twitter: <a rel="nofollow" target="blank" href="https://twitter.com/ykilcher">https://twitter.com/ykilcher</a><br />Discord: <a rel="nofollow" target="blank" href="https://discord.gg/4H8xxDF">https://discord.gg/4H8xxDF</a><br />BitChute: <a rel="nofollow" target="blank" href="https://www.bitchute.com/channel/yannic-kilcher">https://www.bitchute.com/channel/yannic-kilcher</a><br />LinkedIn: <a rel="nofollow" target="blank" href="https://www.linkedin.com/in/ykilcher">https://www.linkedin.com/in/ykilcher</a><br />BiliBili: <a rel="nofollow" target="blank" href="https://space.bilibili.com/2017636191">https://space.bilibili.com/2017636191</a><br /><br />If you want to support me, the best thing to do is to share out the content :)<br /><br />If you want to support me financially (completely optional and voluntary, but a lot of people have asked for this):<br />SubscribeStar: <a rel="nofollow" target="blank" href="https://www.subscribestar.com/yannickilcher">https://www.subscribestar.com/yannickilcher</a><br />Patreon: <a rel="nofollow" target="blank" href="https://www.patreon.com/yannickilcher">https://www.patreon.com/yannickilcher</a><br />Bitcoin (BTC): bc1q49lsw3q325tr58ygf8sudx2dqfguclvngvy2cq<br />Ethereum (ETH): 0x7ad3513E3B8f66799f507Aa7874b1B0eBC7F85e2<br />Litecoin (LTC): LQW2TRyKYetVC8WjFkhpPhtpbDM4Vw7r9m<br />Monero (XMR): 4ACL8AGrEo5hAir8A9CeVrW8pEauWvnp1WnSDZxW7tziCDLhZAGsgzhRQABDnFy8yuM9fWJDviJPHKRjV4FWt19CJZN9D4n{% endraw %}
